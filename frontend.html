<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pediatric Chronic Care App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    .container { margin-top: 20px; }
    .patient-card { margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Pediatric Chronic Care App</h1>

    <!-- Add New Patient Form -->
    <h2>Add New Patient</h2>
    <form id="addPatientForm">
      <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <input type="text" class="form-control" id="name" required>
      </div>
      <div class="mb-3">
        <label for="age" class="form-label">Age</label>
        <input type="number" class="form-control" id="age" required>
      </div>
      <div class="mb-3">
        <label for="chronicCondition" class="form-label">Chronic Condition</label>
        <input type="text" class="form-control" id="chronicCondition" required>
      </div>
      <div class="mb-3">
        <label for="medicalHistory" class="form-label">Medical History </label>
        <input type="text" class="form-control" id="medicalHistory">
      </div>
      <div class="mb-3">
        <label for="appointments" class="form-label">Appointments </label>
        <input type="text" class="form-control" id="appointments">
      </div>
      <div class="mb-3">
        <label for="medicationSchedule" class="form-label">Medication Schedule </label>
        <input type="text" class="form-control" id="medicationSchedule">
      </div>
      <div class="mb-3">
        <label for="emergencyContact" class="form-label">Emergency Contact </label>
        <input type="text" class="form-control" id="emergencyContact">
      </div>
      <button type="submit" class="btn btn-primary">Add Patient</button>
    </form>

    <!-- List of Patients -->
    <h2 class="mt-5">List of Patients</h2>
    <div id="patientsList"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Fetch and display patients when the page loads
      fetchPatients();

      // Add a new patient when the form is submitted
      document.getElementById('addPatientForm').addEventListener('submit', function (e) {
        e.preventDefault();

        // Get form data
        const name = document.getElementById('name').value;
        const age = document.getElementById('age').value;
        const chronicCondition = document.getElementById('chronicCondition').value;
        const medicalHistory = document.getElementById('medicalHistory').value;
        const appointments = document.getElementById('appointments').value;
        const medicationSchedule = document.getElementById('medicationSchedule').value;
        const emergencyContact = document.getElementById('emergencyContact').value;

        // Send POST request to add a new patient
        axios.post('http://localhost:5000/api/patients', {
          name,
          age: parseInt(age),
          chronic_condition: chronicCondition,
          medical_history: medicalHistory,
          appointments: appointments,
          medication_schedule: medicationSchedule,
          emergency_contact: emergencyContact
        })
        .then(response => {
          alert('Patient added successfully');
          fetchPatients();  // Refresh the list of patients
          this.reset();  // Clear the form
        })
        .catch(error => {
          console.error('Error adding patient:', error);
          alert('Error adding patient');
        });
      });
    });

    // Function to fetch and display patients
    function fetchPatients() {
      axios.get('http://localhost:5000/api/patients')
        .then(response => {
          const patients = response.data;
          const patientsList = document.getElementById('patientsList');
          patientsList.innerHTML = '';

          // Display each patient
          patients.forEach(patient => {
            const patientCard = document.createElement('div');
            patientCard.classList.add('patient-card');
            patientCard.innerHTML = `
              <h5>${patient.name}</h5>
              <p><strong>Condition:</strong> ${patient.chronic_condition}</p>
              <p><strong>Age:</strong> ${patient.age}</p>
            `;
            patientsList.appendChild(patientCard);
          });
        })
        .catch(error => {
          console.error('Error fetching patients:', error);
          alert('Error fetching patients');
        });
    }
  </script>
</body>
</html>
